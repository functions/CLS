define("modules/map/geo",["./map"],function(a,b,c){function d(a){for(var b=0;b<h.length;b++)h[b](a),h.splice(b,1);for(var c=0;c<j.length;c++)j[c](a)}function e(a){{var b=0;i.length}for(a.msg=a.info?m[a.info]:m.OTHER;b<i.length;b++)i[b](a),i.splice(b,1);for(var c=0;c<k.length;c++)k[c](a)}var f=a("./map"),g=null,h=[],i=[],j=[],k=[],l=-1,m={PERMISSION_DENIED:"浏览器阻止了定位操作",POSITION_UNAVAILBLE:"无法获得当前位置",TIMEOUT:"定位超时",OTHER:"未知错误"},n={init:function(){return this.getInstance(),this},getInstance:function(a){return g?a&&"function"==typeof a&&a(g):f.plugin("AMap.Geolocation",function(){g=new AMap.Geolocation({enableHighAccuracy:!0,buttonOffset:new AMap.Pixel(10,60),showMarker:!0,showCircle:!0}),f.addControl(g),AMap.event.addListener(g,"complete",d),AMap.event.addListener(g,"error",e),a&&"function"==typeof a&&a(g)}),this},getPosition:function(a,b){this.getInstance(function(c){a&&"function"==typeof a&&h.push(a),b&&"function"==typeof b&&i.push(b),c.getCurrentPosition()})},watchPosition:function(a,b){this.getInstance(function(c){a&&"function"==typeof a&&j.push(a),b&&"function"==typeof b&&k.push(b),l=c.watchPosition()})},unwatchPosition:function(){this.getInstance(function(a){l>0&&(a.clearWatch(l),l=-1)})}};c.exports=n});